<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constrained Lucky Wheel Spinner (Aesthetic Blue Theme)</title>
    <style>
        /*
        ========================================
        AESTHETIC BLUE THEME STYLES
        ========================================
        */
        :root {
            --primary-blue: #3498db; /* Bright Blue */
            --dark-background: #0d1a2b; /* Very Dark Blue-Gray */
            --card-background: #1a2c42; /* Darker Blue-Gray for containers */
            --accent-gold: #f1c40f; /* Yellow/Gold for highlights */
            --text-light: #ecf0f1;
            --text-muted: #bdc3c7;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: var(--dark-background);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            color: var(--text-light);
            background-image: radial-gradient(circle at center, #1b375b 0%, var(--dark-background) 100%);
        }

        .wheel-container {
            position: relative;
            width: 500px;
            height: 500px;
            margin-bottom: 40px;
            border-radius: 50%;
            overflow: hidden;
            /* Added a subtle border/ring effect */
            box-shadow: 
                0 0 50px rgba(52, 152, 219, 0.5), /* Blue glow */
                0 0 100px rgba(13, 26, 43, 0.9) inset; /* Dark inner shadow */
            border: 8px solid var(--primary-blue);
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            /* Assuming 'wheel.png' exists - keeping the original image load */
            background-image: url('wheel.png'); 
            background-size: cover;
            background-position: center;
            
            transform: rotate(0deg); 
            transition-property: transform; 
            transition-duration: 5s;
            transition-timing-function: cubic-bezier(0.25, 0.1, 0.25, 1);
            
            /* Enhanced internal wheel shadow/lighting */
            box-shadow: 
                0 0 30px rgba(0, 0, 0, 0.5) inset, 
                0 0 10px rgba(255, 255, 255, 0.1);
        }

        .pointer {
            position: absolute;
            right: -25px; 
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            clip-path: polygon(0% 50%, 100% 0%, 100% 100%); 
            background-color: var(--accent-gold); /* Gold pointer */
            z-index: 10;
            box-shadow: 0 0 15px var(--accent-gold);
        }
        
        .spin-button {
            padding: 18px 40px;
            font-size: 1.5em;
            font-weight: 700;
            color: var(--dark-background); /* Dark text on bright button */
            background-color: var(--primary-blue); 
            border: none;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 8px 0 #2980b9, 0 15px 30px rgba(0,0,0,0.5); /* 3D effect */
            transition: all 0.2s ease-out;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .spin-button:hover:enabled {
            background-color: #5dade2;
            transform: translateY(-2px);
            box-shadow: 0 10px 0 #2980b9, 0 20px 40px rgba(0,0,0,0.6);
        }

        .spin-button:active:enabled {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #2980b9; 
        }

        .spin-button:disabled {
            background-color: #4a6585;
            box-shadow: none;
            cursor: not-allowed;
            color: var(--text-muted);
        }

        .result-display {
            margin-top: 40px;
            padding: 20px 30px;
            font-size: 1.2em; 
            font-weight: 400;
            color: var(--text-muted); 
            min-height: 80px;
            text-align: center;
            /* Added a container style for the result */
            background-color: var(--card-background);
            border-radius: 10px;
            border: 1px solid #2980b9;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }
        
        .result-display strong {
            display: block;
            font-size: 1.6em;
            color: var(--accent-gold);
            margin-top: 5px;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
        }

    </style>
</head>
<body>

    <div class="wheel-container">
        <div class="wheel" id="luckyWheel"></div>
        <div class="pointer"></div>
    </div>

    <button class="spin-button" id="spinButton">Spin The Wheel!</button>

    <div class="result-display" id="resultDisplay"></div>

    <script>
        const wheel = document.getElementById('luckyWheel');
        const spinButton = document.getElementById('spinButton');
        const resultDisplay = document.getElementById('resultDisplay');

        let isSpinning = false; 

        // --- SIMPLIFIED SAFE ZONE LOGIC ---
        // Forbidden Zone is 0 to 30 degrees (the first slice).
        // Safe range is 30.01 to 359.99 degrees.
        const MIN_TARGET_ANGLE = 31; // 1 degree of buffer past the 30-degree boundary
        const MAX_TARGET_ANGLE = 359; // 1 degree of buffer before the 0-degree boundary
        const SAFE_RANGE_SIZE = MAX_TARGET_ANGLE - MIN_TARGET_ANGLE; 

        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;
            spinButton.disabled = true;
            resultDisplay.innerHTML = "Spinning...";

            // 1. **CRITICAL RESET STEP**: Immediately reset the visual rotation to 0.
            //    This ensures the starting point is consistent every time.
            wheel.style.transitionDuration = '0s';
            wheel.style.transform = 'rotate(0deg)';
            
            // Wait for the visual reset to register before spinning
            setTimeout(() => {
                wheel.style.transitionDuration = '5s';

                // 2. Calculate safe final angle (relative to the 0-degree start)
                let safeRangeAngle = Math.random() * SAFE_RANGE_SIZE; 
                let targetAngle = safeRangeAngle + MIN_TARGET_ANGLE; 
                const finalStopAngle = targetAngle.toFixed(2);

                // 3. Add highly variable full rotations (10 to 20 full turns)
                const fullRotations = Math.floor(Math.random() * 11) + 10; 
                
                // 4. Calculate total rotation: Full spins + (360 - target angle)
                const totalRotation = fullRotations * 360 + (360 - targetAngle);

                // 5. Apply the rotation.
                wheel.style.transform = `rotate(${totalRotation}deg)`;

                // 6. Report results after the animation finishes
                setTimeout(() => {
                    isSpinning = false;
                    spinButton.disabled = false;
                    
                    // The starting rotation is always 0.00° due to the reset
                    resultDisplay.innerHTML = `
                        Starting Rotation: <strong>0.00°</strong> 
                        <br> 
                        Final Stop Angle: <strong>${finalStopAngle}°</strong>
                    `;
                }, 5000); // Wait 5 seconds for the spin animation
                
            }, 50); // Wait 50ms for the visual reset to register
        }

        spinButton.addEventListener('click', spinWheel);
    </script>

</body>
</html>